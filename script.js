let allMusic = [
  {
    name: "Ngân Hà Và Vì Sao",
    artist: "Yihuik Dĩ Tuệ",
    img: "img/music/ngan_ha_va_vi_sao.jpg",
    src: "music/ngan_ha_va_vi_sao.mp3",
    idMusic: "song1",
  },
  {
    name: "Giữ Chặt Cậu",
    artist: "Nhất Khẩu Điềm",
    img: "img/music/giu_chat_cau.jpg",
    src: "music/giu_chat_cau.mp3",
    idMusic: "song2",
  },
  {
    name: "Có Chút Ngọt Ngào",
    artist: " Uông Tô Lang ft BY2",
    img: "img/music/co_chut_ngot_ngao.jpg",
    src: "music/co_chut_ngot_ngao.mp3",
    idMusic: "song3",
  },
  {
    name: "Nổi Gió Rồi",
    artist: "Châu Thâm",
    img: "img/music/noi_gio_roi.jpg",
    src: "music/noi_gio_roi.mp3",
    idMusic: "song4",
  },
  {
    name: "Đáp Án Của Bạn",
    artist: "A Nhũng",
    img: "img/music/dap_an_cua_ban.jpg",
    src: "music/dap_an_cua_ban.mp3",
    idMusic: "song5",
  },
  {
    name: "Dũng Khí",
    artist: "Miên Tử",
    img: "img/music/dung_khi.jpg",
    src: "music/dung_khi.mp3",
    idMusic: "song6",
  },
  {
    name: "Tình Sương",
    artist: "Dương Tử",
    img: "img/music/tinh_suong.jpg",
    src: "music/tinh_suong.mp3",
    idMusic: "song7",
  },
  {
    name: "Bạch Nguyệt Quang Và Nốt Chu Sa",
    artist: "Bàn Hổ",
    img: "img/music/bach_nguyet_quang_va_not_chu_sa.jpg",
    src: "music/bach_nguyet_quang_va_not_chu_sa.mp3",
    idMusic: "song8",
  },
  {
    name: "Tứ Ngã",
    artist: "Hứa Lam Tâm • Nhất Khoả Lang Tinh",
    img: "img/music/tu_nga.jpg",
    src: "music/tu_nga.mp3",
    idMusic: "song9",
  },
  {
    name: "Tam Bái Hồng Trần Lương",
    artist: "Doãn Tích Miên",
    img: "img/music/tam_bai_hong_tran_luong.jpg",
    src: "music/tam_bai_hong_tran_luong.mp3",
    idMusic: "song10",
  },
  {
    name: "9420",
    artist: "Mạch Tiểu Đâu",
    img: "img/music/9420.jpeg",
    src: "music/9420.mp3",
    idMusic: "song11",
  },
  {
    name: "Hoa Rơi Thành Bùn",
    artist: "Cúc Tịnh Y",
    img: "img/music/hoa_roi_thanh_bun.jpg",
    src: "music/hoa_roi_thanh_bun.mp3",
    idMusic: "song12",
  },
  {
    name: "Không Thán Hề",
    artist: "Ngạo Thất Gia",
    img: "img/music/khong_than_he.jpg",
    src: "music/khong_than_he.mp3",
    idMusic: "song13",
  },
  {
    name: "Quảng Hàn Cung",
    artist: "Hoàn Tử U",
    img: "img/music/quang_han_cung.jpg",
    src: "music/quang_han_cung.mp3",
    idMusic: "song14",
  },
  {
    name: "Trong Mắt Đều Là Anh",
    artist: "Tiểu Lam Bối Tâm",
    img: "img/music/trong_mat_deu_la_anh.jpg",
    src: "music/trong_mat_deu_la_anh.mp3",
    idMusic: "song15",
  },
  {
    name: "Vây Giữ",
    artist: "Vương Tĩnh Văn Không Mập",
    img: "img/music/vay_giu.jpg",
    src: "music/vay_giu.mp3",
    idMusic: "song16",
  },
  {
    name: "Xuy Diệt Tiểu Sơn Hà",
    artist: "Tư Nam",
    img: "img/music/xuy_diet_tieu_son_ha.jpg",
    src: "music/xuy_diet_tieu_son_ha.mp3",
    idMusic: "song17",
  },
  {
    name: "Yến Vô Hiết",
    artist: "Tương Tuyết Nhi",
    img: "img/music/yen_vo_hiet.jpg",
    src: "music/yen_vo_hiet.mp3",
    idMusic: "song18",
  },
  {
    name: "Xuy Mộng Đáo Tây Châu",
    artist: "Yêu Dương & Hoàng Thi Phù",
    img: "img/music/xuy_mong_dao_tay_chau.jpg",
    src: "music/xuy_mong_dao_tay_chau.mp3",
    idMusic: "song19",
  },
  {
    name: "Tay Trái Chỉ Trăng",
    artist: "Tát Đỉnh Đỉnh",
    img: "img/music/tay_trai_chi_trang.jpg",
    src: "music/tay_trai_chi_trang.mp3",
    idMusic: "song20",
  },
  {
    name: "Người Theo Đuổi Ánh Sáng",
    artist: "Từ Vi",
    img: "img/music/nguoi_theo_duoi_anh_sang.jpg",
    src: "music/nguoi_theo_duoi_anh_sang.mp3",
    idMusic: "song21",
  },
  {
    name: "Kiêu Ngạo",
    artist: "en",
    img: "img/music/kieu_ngao.jpg",
    src: "music/kieu_ngao.mp3",
    idMusic: "song22",
  },
  {
    name: "Người Kế Nhiệm",
    artist: "Nhậm Nhiên",
    img: "img/music/nguoi_ke_nhiem.jpg",
    src: "music/nguoi_ke_nhiem.mp3",
    idMusic: "song23",
  },
  {
    name: "Phi Điểu Và Ve Sầu",
    artist: "Nhậm Nhiên",
    img: "img/music/phi_dieu_va_ve_sau.jpg",
    src: "music/phi_dieu_va_ve_sau.mp3",
    idMusic: "song24",
  },
  {
    name: "Trích Tiên",
    artist: "Diệp Lý ft Y Cách Tái Thính",
    img: "img/music/trich_tien.jpg",
    src: "music/trich_tien.mp3",
    idMusic: "song25",
  },
  {
    name: "Vạn Vật Hấp Dẫn",
    artist: "F*yy",
    img: "img/music/van_vat_hap_dan.jpg",
    src: "music/van_vat_hap_dan.mp3",
    idMusic: "song26",
  },
  {
    name: "Bóng Dáng Sao Trời",
    artist: "Lam Tâm Vũ",
    img: "img/music/bong_dang_sao_troi.jpg",
    src: "music/bong_dang_sao_troi.mp3",
    idMusic: "song27",
  },
  {
    name: "Không Biết Phải Làm Sao",
    artist: "Vương Tĩnh Văn Không Mập",
    img: "img/music/khong_biet_phai_lam_sao.jpg",
    src: "music/khong_biet_phai_lam_sao.mp3",
    idMusic: "song28",
  },
  {
    name: "Hạ Sơn",
    artist: "Yếu Bất Yếu Mãi Thái",
    img: "img/music/ha_son.jpg",
    src: "music/ha_son.mp3",
    idMusic: "song29",
  },
  {
    name: "Tam Sinh Tam Thế",
    artist: "Trương Kiệt",
    img: "img/music/tam_sinh_tam_the.jpg",
    src: "music/tam_sinh_tam_the.mp3",
    idMusic: "song30",
  },
  {
    name: "Xuất Sơn",
    artist: "Hoa Chúc & Vương Thắng Nam",
    img: "img/music/xuat_son.jpg",
    src: "music/xuat_son.mp3",
    idMusic: "song31",
  },
  {
    name: "Một Đường Nở Hoa",
    artist: "Ôn Dịch Tâm",
    img: "img/music/mot_duong_no_hoa.jpg",
    src: "music/mot_duong_no_hoa.mp3",
    idMusic: "song32",
  },
  {
    name: "Mashup Hit Tiktok 2020",
    artist: "Nhiều ca sĩ",
    img: "img/music/mashup_1.jpg",
    src: "music/mashup_1.mp3",
    idMusic: "song33",
  },
  {
    name: "Nửa Đời Tuyết",
    artist: "Tương Tuyết Nhi",
    img: "img/music/nua_doi_tuyet.jpg",
    src: "music/nua_doi_tuyet.mp3",
    idMusic: "song34",
  },
  {
    name: "Ma Pháp Tình Yêu",
    artist: "Kim Sa",
    img: "img/music/ma_phap_tinh_yeu.jpg",
    src: "music/ma_phap_tinh_yeu.mp3",
    idMusic: "song35",
  },
  {
    name: "Quy Khứ Lai Hề",
    artist: "Diệp Huyền Thanh",
    img: "img/music/quy_khu_lai_he.jpg",
    src: "music/quy_khu_lai_he.mp3",
    idMusic: "song36",
  },
  {
    name: "Thán Vân Hề",
    artist: "Cúc Tịnh Y",
    img: "img/music/than_van_he.jpg",
    src: "music/than_van_he.mp3",
    idMusic: "song37",
  },
  {
    name: "Đông Miên",
    artist: "Tư Nam",
    img: "img/music/dong_mien.jpg",
    src: "music/dong_mien.mp3",
    idMusic: "song38",
  },
  {
    name: "Giấc Mơ Không Thể Đánh Thức",
    artist: "Thập Nhị",
    img: "img/music/giac_mo_khong_the_danh_thuc.jpg",
    src: "music/giac_mo_khong_the_danh_thuc.mp3",
    idMusic: "song39",
  },
  {
    name: "Thời Không Sai Lệch",
    artist: "Ngải Thần",
    img: "img/music/thoi_khong_sai_lech.jpg",
    src: "music/thoi_khong_sai_lech.mp3",
    idMusic: "song40",
  },
  {
    name: "Tát Nhật Lãng Rực Rỡ",
    artist: "Yếu Bất Yếu Mãi Thái",
    img: "img/music/tat_nhat_lang_ruc_ro.jpg",
    src: "music/tat_nhat_lang_ruc_ro.mp3",
    idMusic: "song41",
  },
  {
    name: "Thanh Trừ",
    artist: "Vương Hân Thần, Tô Tinh Tiệp",
    img: "img/music/thanh_tru.jpg",
    src: "music/thanh_tru.mp3",
    idMusic: "song42",
  },
  {
    name: "Kẹo Trăng Sao",
    artist: "Lê Lâm Thiêm Kiều",
    img: "img/music/keo_trang_sao.jpg",
    src: "music/keo_trang_sao.mp3",
    idMusic: "song43",
  },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song44",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song45",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song46",
  //   },

  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song47",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song48",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song49",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song50",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song51",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song52",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song53",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song54",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song55",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song56",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song57",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song58",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song59",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song60",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song61",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song62",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song63",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song64",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song65",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song66",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song67",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song68",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song69",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song70",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song71",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song72",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song73",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song74",
  //   },
  //   {
  //     name: "",
  //     artist: "",
  //     img: "img/music/.jpg",
  //     src: "music/.mp3",
  //     idMusic: "song75",
  //   },
];

const playlist = document.querySelector(".playlist");
const cd = document.querySelector(".cd");
const cdThumb = document.querySelector(".cd-thumb");
const musicName = document.querySelector("header h2");
const musicArtist = document.querySelector("header h3");
const progress = document.querySelector(".progress");
const progressbar = document.querySelector(".progress-bar");
const myControlBtn = document.querySelector("#btn-my-controls");
const myControls = document.querySelector("#btn-my-controls #icon");
const prevBtn = document.querySelector("#btn-prev");
const nextBtn = document.querySelector("#btn-next");
const playBtn = document.querySelector("#btn-play");
const playbackTimeBtn = document.querySelector("#btn-playback-time");
const playbackTimer = document.querySelector(".playback-timer");
const songAudio = document.createElement("audio");

let currentIndex = 0;
let isPlaying = false;
let isRandom = false;
let isRepeat = false;
let isPlaybackTime = false;
let stopMusic = null;
let countdown = null;

window.addEventListener("load", () => {
  loadMusic(currentIndex);
  playSongMusic();
});

// Playlist
for (let i = 0; i < allMusic.length; i++) {
  let song = `<div class="song" musicIndex="${i}">
                <div class="left">
                  <div
                    class="img-song"
                    style="background-image: url('${allMusic[i].img}')">
                  </div>
                  <div class="song-title">
                    <h3 class="name">${allMusic[i].name}</h3>
                    <p class="artist">${allMusic[i].artist}</p>
                  </div>
                </div>
                <audio class="${allMusic[i].idMusic}" src="${allMusic[i].src}">
                </audio>
                <div id="${allMusic[i].idMusic}" class="audio-duration">
                  <i class="fas fa-ellipsis-h"></i>
                </div>
                </div>`;
  playlist.insertAdjacentHTML("beforeend", song);
  let songAudioDuration = document.querySelector(`#${allMusic[i].idMusic}`);
  let songAudioTag = document.querySelector(`.${allMusic[i].idMusic}`);
  // -------hiển thị thời gian bài hát------------
  songAudioTag.addEventListener("loadeddata", () => {
    let audioDuration = songAudioTag.duration;
    let totalMusicmin = Math.floor(audioDuration / 60);
    let totalMusicsec = Math.floor(audioDuration % 60);
    if (totalMusicsec < 10) {
      totalMusicsec = `0${totalMusicsec}`;
    }
    songAudioDuration.innerText = `${totalMusicmin}:${totalMusicsec}`;
  });
}
//
const allSongMusic = playlist.querySelectorAll(".song");

function playSongMusic() {
  for (let j = 0; j < allSongMusic.length; j++) {
    if (allSongMusic[j].classList.contains("active")) {
      allSongMusic[j].classList.remove("active");
    }
    if (allSongMusic[j].getAttribute("musicIndex") == currentIndex) {
      allSongMusic[j].classList.add("active");
    }
    allSongMusic[j].setAttribute("onclick", "clicked(this)");
  }
}

function clicked(index) {
  let getSongIndex = index.getAttribute("musicindex");
  currentIndex = getSongIndex;
  loadMusic(currentIndex);
  playSong();
  playSongMusic();
}

function scrollToActiveSong() {
  setTimeout(() => {
    const activeSong = document.querySelector(".song.active");
    if (activeSong) {
      activeSong.scrollIntoView({
        behavior: "smooth",
        block: "nearest",
      });
    }
  }, 300);
}

// Load Music
function loadMusic(index) {
  musicName.innerText = allMusic[index].name;
  musicArtist.innerText = allMusic[index].artist;
  cdThumb.style.backgroundImage = `url(${allMusic[index].img})`;
  songAudio.src = allMusic[index].src;
  songAudio.load();
}
loadMusic(currentIndex);

// Phóng to / Thu nhỏ CD
const cdWidth = cd.offsetWidth;

document.onscroll = function () {
  const scrollTop = window.scrollY || document.documentElement.scrollTop;
  const newCdWidth = cdWidth - scrollTop;

  cd.style.width = newCdWidth > 0 ? newCdWidth + "px" : 0;
  cd.style.opacity = newCdWidth / cdWidth;
};

// Xử lý CD quay / dừng
const cdThumbAnimation = cdThumb.animate([{ transform: "rotate(360deg)" }], {
  duration: 10000,
  iterations: Infinity,
});
cdThumbAnimation.pause();

// Play song
function musicPlay() {
  if (isPlaying) {
    pauseSong();
  } else {
    playSong();
  }
}
function playSong() {
  songAudio.play();
  cdThumbAnimation.play();
  isPlaying = true;
  playBtn.title = "Pause";
  playBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
}

function pauseSong() {
  songAudio.pause();
  cdThumbAnimation.pause();
  isPlaying = false;
  playBtn.title = "Play";
  playBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
}

// Next song
function nextSong() {
  if (isRandom) {
    currentIndex = randomSong();
  } else if (currentIndex < allMusic.length - 1) {
    currentIndex++;
  } else {
    currentIndex = 0;
  }
  loadMusic(currentIndex);
  playSongMusic();
  playSong();
  scrollToActiveSong();
}
nextBtn.onclick = function () {
  nextSong();
};

// Prev song
function prevSong() {
  if (isRandom) {
    currentIndex = randomSong();
  } else if (currentIndex > 0) {
    currentIndex--;
  } else {
    currentIndex = allMusic.length - 1;
  }
  loadMusic(currentIndex);
  playSongMusic();
  playSong();
  scrollToActiveSong();
}
prevBtn.onclick = function () {
  prevSong();
};

// Tự động chuyển bài khi kết thúc
songAudio.addEventListener("ended", () => {
  if (isRepeat) {
    songAudio.play();
  } else {
    nextSong();
  }
});

// Random & Repeat
myControlBtn.addEventListener("click", function () {
  if (
    myControls.classList.contains("fa-shuffle") &&
    !myControls.classList.contains("pink")
  ) {
    isRandom = !isRandom;
    myControlBtn.title = "Repeat";
    myControls.classList.add("pink");
  } else if (
    myControls.classList.contains("fa-shuffle") &&
    myControls.classList.contains("pink")
  ) {
    isRandom = !isRandom;
    isRepeat = !isRepeat;
    myControlBtn.title = "Random";
    myControls.classList.remove("fa-shuffle");
    myControls.classList.add("fa-repeat");
  } else {
    isRepeat = !isRepeat;
    myControls.classList.add("fa-shuffle");
    myControls.classList.remove("fa-repeat");
    myControls.classList.remove("pink");
  }
});

let playedSongs = [];
function randomSong() {
  let randomIndex;
  let randomSong;
  do {
    randomIndex = Math.floor(Math.random() * allMusic.length);
    randomSong = allMusic[randomIndex];
  } while (playedSongs.includes(randomSong));

  // Thêm bài hát được random vào danh sách các bài đã được phát
  playedSongs.push(randomSong);

  // Nếu tất cả bài hát đã được phát thì reset lại danh sách
  if (playedSongs.length == allMusic.length) {
    playedSongs = [];
  }
  return randomIndex;
}

// Lấy tham chiếu đến phần tử bảng chọn
// let dropdownMenu = document.querySelector(".dropdown-menu");
// let dropdownOptions = document.querySelectorAll(".dropdown-menu li");

// playbackTimeBtn.addEventListener("click", function () {
//   dropdownMenu.classList.toggle("show");
// });

// dropdownOptions.forEach(function (option) {
//   option.addEventListener("click", function () {
//     let selectedValue = option.getAttribute("data-value");
//     console.log("Đã chọn: ", selectedValue);
//     dropdownOptions.addEventListener("click", function () {
//       dropdownMenu.classList.remove("show");
//       playbackTime(selectedValue);
//     });
//     // Gọi function hoặc thực hiện các thao tác khác ở đây
//   });
// });

// Playback time
let stopTime = 3600;
function playbackTime() {
  if (!isPlaybackTime) {
    playbackTimeBtn.classList.add("pink");
    playbackTimer.classList.add("show");
    // CountDown
    let minutes = Math.floor(stopTime / 60);
    let seconds = Math.floor(stopTime % 60);
    if (seconds < 10) {
      seconds = `0${seconds}`;
    }
    playbackTimer.innerText = `${minutes}:${seconds}`;
    countdown = setInterval(function () {
      if (seconds == 0) {
        seconds = 59;
        minutes--;
      } else {
        seconds--;
      }
      if (seconds < 10) {
        seconds = `0${seconds}`;
      }
      playbackTimer.innerText = `${minutes}:${seconds}`;
    }, 1000);
    // Stop Music
    stopMusic = setTimeout(function () {
      playbackTimeBtn.classList.remove("pink");
      playbackTimer.classList.remove("show");
      clearInterval(countdown);
      isPlaybackTime = false;
      pauseSong();
    }, stopTime * 1000);
    isPlaybackTime = true;
  } else {
    clearTimeout(stopMusic);
    clearInterval(countdown);
    playbackTimeBtn.classList.remove("pink");
    playbackTimer.classList.remove("show");
    isPlaybackTime = false;
  }
}

playbackTimeBtn.addEventListener("click", function () {
  playbackTime();
});
// progress
songAudio.addEventListener("timeupdate", (e) => {
  const currentTime = e.target.currentTime;
  const duration = e.target.duration;
  let progressWidth = (currentTime / duration) * 100;
  progressbar.style.width = `${progressWidth}%`;

  let musicCurrentTime = document.querySelector(".current");
  let musicDuration = document.querySelector(".duration");
  songAudio.addEventListener("loadeddata", () => {
    let audioduration = songAudio.duration;
    let totalMusicmin = Math.floor(audioduration / 60);
    let totalMusicsec = Math.floor(audioduration % 60);
    if (totalMusicsec < 10) {
      totalMusicsec = `0${totalMusicsec}`;
    }
    musicDuration.innerText = `${totalMusicmin}:${totalMusicsec}`;
  });
  let currentMusicmin = Math.floor(currentTime / 60);
  let currentMusicsec = Math.floor(currentTime % 60);
  if (currentMusicsec < 10) {
    currentMusicsec = `0${currentMusicsec}`;
  }
  musicCurrentTime.innerText = `${currentMusicmin}:${currentMusicsec}`;
});

// ----------- Tua nhạc-------
progress.addEventListener("click", (e) => {
  let progressWidthval = progress.clientWidth;
  let clickOffsetX = e.offsetX;
  let songDuration = songAudio.duration;
  songAudio.currentTime = (clickOffsetX / progressWidthval) * songDuration;
  playSong();
});
